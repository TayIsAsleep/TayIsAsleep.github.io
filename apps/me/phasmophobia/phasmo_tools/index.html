<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Phasmophobia Tools</title>
        <meta property="og:title" content="Phasmophobia Evidence Tracker">
        <meta property="og:description" content="Helps you keep track of the evidence you have found in Phasmophobia!">

        <meta http-equiv='cache-control' content='no-cache'>
        <meta http-equiv='expires' content='0'>
        <meta http-equiv='pragma' content='no-cache'>

        <link rel="icon" type="image/png" href="./img/favicon.jpg">
        <link rel="apple-touch-icon" sizes="180x180" href="./img/apple-touch-icon.png">
        
        <link rel="stylesheet" href="./css/style.css?random=2398933440">

        <script type="text/javascript" src="../../../../global/js/jquery-3.6.0.min.js"></script>
        <script type="text/javascript" src="../../../../global/js/uri.js?random=2398933440"></script>
        <script type="text/javascript" src="../../../../js/script.js?random=2398933440"></script>
        <script type="text/javascript" src="../../../../global/js/scripts.js?random=2398933440"></script>
        <script type="text/javascript" src="./js/phasmo_tools.js?random=2398933440" defer></script>
    </head>
    <body>
        
        <!-- #region Background images -->
        <div id="bg-image" style="opacity: 0;"></div>
        <script>
            /* IDK why, but these has to be in the HTML code for it to work properly */
            function generate_bg_images(){
                let dest = document.getElementById("bg-image");
                let image_count_string = "image_count_string_1_12_image_count_string_2";
                let image_count = parseInt(image_count_string.split("string_1_")[1].split("_image")[0])

                for (let i = 1; i < image_count; i++) {
                    let new_image = document.createElement("img");
                    
                    new_image.src = `./img/bg/bg${i}.jpg`;
                    new_image.alt = `bg${i}`;
                    new_image.classList.add("bg-image");

                    dest.appendChild(new_image);
                }
            };
            generate_bg_images();
        </script>
        <!-- #endregion -->
        
        <div class="main-container" style="opacity: 0;">
            <!-- #region Tool Selector -->
            <div class="tool tool-selector">
                <div class="title">
                    <h1>Phasmophobia Tools</h1>
                    <h5>Made by <a target="_blank" href="https://github.com/TayIsAsleep">TayIsAsleep</a></h5>
                </div>

                <br>
                
                <p>Press <a href="?app=evidence_tracker">here</a> to go to the Phasmophobia Evidence Tracker</p>
                <p>Press <a href="?app=item_randomizer">here</a> to go to the Phasmophobia Item Randomizer</p>
            </div>
            <!-- #endregion -->
            <!-- #region Evidence Tracker -->
            <div class="tool tool-evidence-tracker">
                <script>
                    var ghosts_evidence = {
                        "Shade":[
                            "evidence_found_emf5",
                            "evidence_found_orbs",
                            "evidence_found_writing"
                        ],
                        "Phantom":[
                            "evidence_found_emf5",
                            "evidence_found_orbs",
                            "evidence_found_freezing_temps"
                        ],
                        "Jinn":[
                            "evidence_found_emf5",
                            "evidence_found_orbs",
                            "evidence_found_spirit_box"
                        ],
                        "Yurei":[
                            "evidence_found_freezing_temps",
                            "evidence_found_orbs",
                            "evidence_found_writing"
                        ],
                        "Mare":[
                            "evidence_found_freezing_temps",
                            "evidence_found_orbs",
                            "evidence_found_spirit_box"
                        ],
                        "Demon":[
                            "evidence_found_freezing_temps",
                            "evidence_found_spirit_box",
                            "evidence_found_writing"
                        ],
                        "Banshee":[
                            "evidence_found_emf5",
                            "evidence_found_freezing_temps",
                            "evidence_found_fingerprints"
                        ],
                        "Revenant":[
                            "evidence_found_emf5",
                            "evidence_found_fingerprints",
                            "evidence_found_writing"
                        ],
                        "Oni":[
                            "evidence_found_emf5",
                            "evidence_found_spirit_box",
                            "evidence_found_writing"
                        ],
                        "Poltergeist":[
                            "evidence_found_fingerprints",
                            "evidence_found_orbs",
                            "evidence_found_spirit_box"
                        ],
                        "Spirit":[
                            "evidence_found_spirit_box",
                            "evidence_found_fingerprints",
                            "evidence_found_writing"
                        ],
                        "Wraith":[
                            "evidence_found_freezing_temps",
                            "evidence_found_spirit_box",
                            "evidence_found_fingerprints"
                        ]
                    };

                    if (new URLSearchParams(window.location.search).get("beta") == "1"){
                        ghosts_evidence["Yokai"] = [
                            "evidence_found_spirit_box",
                            "evidence_found_orbs",
                            "evidence_found_writing"
                        ]
                        ghosts_evidence["Hantu"] = [
                            "evidence_found_fingerprints",
                            "evidence_found_orbs",
                            "evidence_found_writing"
                        ]
                    };

                    ghosts_evidence = sortObjectByKeys(ghosts_evidence)

                </script>
                <div class="title">
                    <h1>Phasmophobia Evidence Tracker</h1>
                    <h5>Made by <a target="_blank" href="https://github.com/TayIsAsleep">TayIsAsleep</a></h5>
                </div>
                
                <br>

                <div class="main-content">

                    <div class="ghosts-it-could-be-container"></div>

                    <div class="buttons evidence-buttons"></div>
                    
                    <div class="break"></div>

                    <br>

                    <div class="ghosts-cant-be-container">
                        <p style="text-align: center;">It can't be...</p>
                        <div class="ghosts-cant-be"></div>
                    </div>
                    
                </div>

                <script>
                    /* IDK why, but these has to be in the HTML code for it to work properly */
                    function generate_evidence_buttons(){
                        let dest = document.getElementsByClassName("evidence-buttons")[0];
                        [
                            ["emf5","EMF Level 5"],
                            ["ghost-orbs","Ghost Orbs"],
                            ["ghost-writing","Ghost Writing"],
                            ["freezing-temps","Freezing Temperatures"],
                            ["spirit-box","Spirit Box"],
                            ["fingerprints","Fingerprints"]   
                        ].forEach(current => {
                            let new_button = document.createElement("div");
                            let new_button_text = document.createElement("p");
                            let new_button_icon = document.createElement("img");
                            
                            new_button_text.innerHTML = current[1];

                            new_button_icon.src = `./img/icon-evidence-${current[0]}.svg`;
                            new_button_icon.alt = `${current[0]} icon`; 

                            new_button.appendChild(new_button_text);
                            new_button.appendChild(new_button_icon);
                            new_button.classList.add("button", "evidence-button");

                            /* ICONS */
                            // new_button.classList.add("icon-button");

                            new_button.id = `button-evidence-${current[0]}`;

                            dest.appendChild(new_button);
                            // dest.appendChild(document.createElement("br"));
                        });

                        // dest.appendChild(document.createElement("br")); //Add the extra BR

                        let new_button = document.createElement("div");
                        let new_button_text = document.createElement("p");
                        new_button.id = "button-evidence-reset";
                        new_button.classList.add("button", "evidence-button")
                        new_button_text.innerHTML = "Reset";
                        new_button.appendChild(new_button_text);
                        dest.appendChild(new_button);
                    }
                    function generate_ghosts_cant_be(){
                        let dest = document.getElementsByClassName("ghosts-cant-be")[0];
                        
                        Object.keys(ghosts_evidence).forEach(current => {
                            let new_button = document.createElement("div");
                            let new_button_text = document.createElement("p");

                            new_button_text.innerHTML = current;

                            new_button.appendChild(new_button_text);
                            new_button.classList.add("button", "button-ghost-cant-be");
                            new_button.id = `button-ghost-${current.toLowerCase()}`;
                            new_button.setAttribute('value', '0');

                            dest.appendChild(new_button);
                        });
                    }

                    generate_evidence_buttons();
                    generate_ghosts_cant_be();
                </script>

            </div>
            <!-- #endregion -->
            <!-- #region Item Randomizer -->
            <div class="tool tool-item-randomizer">

                <div class="title">
                    <h1>Phasmophobia Item Randomizer</h1>
                    <h5>Made by <a target="_blank" href="https://github.com/TayIsAsleep">TayIsAsleep</a></h5>
                </div>
    
                <br>
    
                <div class="fields">

                    <form class="selection-field"></form>
                    <script>
                        /* IDK why, but these has to be in the HTML code for it to work properly */
                        function generate_selection_field(){
                            let dest = document.getElementsByClassName("selection-field")[0];
                            [
                                "EMF Reader",
                                "Flashlight",
                                "Photo Camera",
                                "Lighter",
                                "Candle",
                                "UV Light",
                                "Crucifix",
                                "Video Camera",
                                "Spirit Box",
                                "Salt",
                                "Smudge Sticks",
                                "Tripod",
                                "Strong Flashlight",
                                "Motion Sensor",
                                "Sound Sensor",
                                "Thermometer",
                                "Sanity Pills",
                                "Ghost Writing Book",
                                "Infrared Light Sensor",
                                "Parabolic Microphone",
                                "Glowstick",
                                "Head Mounted Camera"
                            ].sort().forEach(current => {
                                
                                let new_div = document.createElement("div");
                                let new_input = document.createElement("input");
                                let new_label = document.createElement("label");

                                new_input.id = current.toLowerCase().replaceAll(" ","-");
                                new_input.classList.add("item-option");
                                new_input.setAttribute('displayname', current);
                                new_input.setAttribute('type', "checkbox");
                                new_input.setAttribute('name', current.toLowerCase().replaceAll(" ","-"));
                                new_input.setAttribute('value', current.toLowerCase().replaceAll(" ","-"));
                                new_input.setAttribute('checked', "");

                                new_label.innerHTML = current;
                                new_label.setAttribute('for', current.toLowerCase().replaceAll(" ","-"));

                                new_div.appendChild(new_input);
                                new_div.appendChild(new_label);
                                new_div.appendChild(document.createElement("br"));

                                dest.appendChild(new_div);
                            });
                        };
                        generate_selection_field();
                    </script>
    
                    <div class="output-field"></div>
                </div>
    
                <br><br>
                
                <div class="buttons">
                    <div id="select-all-button" class="button"><p>Select All</p></div>
                    <div id="deselect-all-button" class="button"><p>Deselect All</p></div>
                    <div id="draw-item-button" class="button"><p>Roll an item</p></div>
                    <div id="draw-all-button" class="button"><p>Roll all</p></div>
                    <div id="reset-button" class="button"><p>Reset</p></div>
                </div>

            </div>
            <!-- #endregion -->

            <script>
                $(".tool").css("display","none"); // Hides all tools by default

                let url_params = new URLSearchParams(window.location.search);
                let initial_app = url_params.get('app');
                let options = {
                    "evidence_tracker":[".tool-evidence-tracker","Evidence Tracker"],
                    "item_randomizer":[".tool-item-randomizer","Item Randomizer"]
                }
                if (Object.keys(options).includes(initial_app)){
                    initial_app = options[initial_app];
                    
                    // Create beta button:
                    let is_beta = (url_params.get("beta") == "1");
                    let b = document.createElement("div");
                    b.classList.add(
                        "button",
                        (is_beta ? "beta-ghost-button" : "stable-ghost-button")
                    );
                    b.setAttribute("onclick",`updateURLParameterLive({'beta':'${(is_beta ? "0" : "1")}'}); update_hash();`);
                    b.style.maxWidth = "max-content";
                    b.innerText = (is_beta ? "Not on beta?" : "Looking for the new beta ghosts?")
                    document.querySelector(".tool-evidence-tracker .main-content").appendChild(b)
                }
                else{
                    initial_app = [".tool-selector","Phasmophobia Tools"];
                }
                $(initial_app[0]).css("display","inline"); // Only shows the selected
                document.title = initial_app[1];
            </script>

        </div>

        <div class="loader"></div>

        <!-- <script>
            // Code from https://stackoverflow.com/a/10338754/13921835
            $(window).focus(function() {
                console.log("a")
            });

            $(window).blur(function() {
                console.log("b")
            });
        </script> -->

    </body>
</html>
